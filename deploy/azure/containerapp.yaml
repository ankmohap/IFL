location: eastus
name: ifl-fantasy-app
properties:
  managedEnvironmentId: /subscriptions/<SUBSCRIPTION_ID>/resourceGroups/<RG_NAME>/providers/Microsoft.App/managedEnvironments/<ENV_NAME>
  configuration:
    ingress:
      external: true
      targetPort: 4000
      transport: auto
    registries:
      - server: <ACR_NAME>.azurecr.io
        username: <ACR_USERNAME>
        passwordSecretRef: acr-password
    secrets:
      - name: acr-password
        value: <ACR_PASSWORD>
  template:
    containers:
      - image: <ACR_NAME>.azurecr.io/ifl-fullstack:latest
        name: ifl-app
        env:
          - name: PORT
            value: "4000"
          - name: DB_PATH
            value: /data/ifl.sqlite3
        resources:
          cpu: 0.5
          memory: 1Gi
        volumeMounts:
          - volumeName: data
            mountPath: /data
    volumes:
      - name: data
        storageType: EmptyDir
    scale:
      minReplicas: 1
      maxReplicas: 3
